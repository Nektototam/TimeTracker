# Технический аудит TimeTracker (краткий отчет)

Дата: 2 февраля 2026

## 1) Текущий стек и структура

- Frontend: Next.js (App Router), React, TypeScript, Tailwind.
- Backend: отсутствует (все вызовы напрямую в Supabase из клиента).
- Auth: Supabase Auth (email/password), client-side SDK.
- БД: Supabase Postgres (через supabase-js).

## 2) Ключевой функционал (по коду)

Сохранить обязательно:
- Таймер и трекинг задач (start/pause/finish).
- Проекты/типы работ (custom project types).
- Отчеты по периодам.
- Pomodoro-режим.
- Настройки пользователя (часть в БД + localStorage).
- Локализация (i18n).

## 3) Технические риски и долги

- Зависимость от Supabase в клиентском коде практически повсеместно:
  - AuthContext, hooks, services, страницы auth.
- База данных описана частично:
  - есть таблица user_settings и миграция по retention,
  - нет SQL-скриптов на time_entries и custom_project_types.
- Settings UI частично заглушка (сохранение/очистка «имитируются», не используют сервис).
- Логика отчетов выполняется на клиенте, присутствуют фильтрации и коррекции данных.

## 4) Что нужно для миграции на Railway + Fastify + Prisma

- Собственный API с полноценной авторизацией (session/JWT).
- Полная схема БД и миграции:
  - users
  - sessions или refresh_tokens
  - time_entries
  - user_settings
  - custom_project_types
- API для отчетов с агрегацией на сервере.
- Плановая очистка старых записей через Railway Cron.

## 5) Вывод

Проект рабочий как фронтенд, но критически зависит от Supabase. Для переноса на Railway потребуется выделение backend и формализация схемы. Функционал сохранен, но часть настроек требует доведения до реального хранения.

## 6) Рекомендуемый порядок работ

1) Утвердить функционал (минимальный список).
2) Спроектировать схему БД.
3) Поднять API на Fastify + Prisma.
4) Заменить Supabase SDK на API-клиент.
5) Доработать настройки и отчеты.
6) Настроить деплой на Railway.
